<%- include("../template/header", {title:'Admin'}) %>
    
    <link rel="stylesheet" href="css/Admin.css">
</head>

<body>
    <div class="Pagina_Principal">

        <%- include("../template/navbar") %>
        <div class="Principal container-fluid">
            <br> 
            <ul class="nav-p nav nav-pills mb-3" id="pills-tab" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="pills-home-tab" data-bs-toggle="pill" data-bs-target="#pills-1" type="button" role="tab" aria-controls="pills-home" aria-selected="true">Administrar Hojas de reparacion&nbsp;&nbsp;<i class="fas fa-car"></i></button>
                </li>
                
            </ul>
            <div class="tab-content" id="pills-tabContent">
                <div class="tab-pane fade show active" id="pills-1" role="tabpanel" aria-labelledby="pills-home-tab">
                    <button id="btncrear" class="btn btn-success mb-2 "> a√±adir </button>
                    <table id="Admin-Clientes" class="table table-bordered">
                        <thead>
                            <tr>
                                <th scope="col">RECEPCION #</th>
                                <th scope="col">CLIENTE:</th>
                                <th scope="col">VEHICULO A REPARAR:</th>
                                <th scope="col">REPARACIONES:</th>
                                <th scope="col">MECANICOS ENCARGADOS:</th>
                                <th scope="col">VIDEO INGRESO</th>
                                <th scope="col">ACCIONES</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% var i=0; lista_recepcion.forEach(recepcion => { %>
                            <tr>
                                <th><%= recepcion.id_recepcion %> </th>
                                <th><%= arrclientes[recepcion.id_cliente] %></th>
                                <th><%= arrvehiculos[recepcion.id_vehiculo] %> </th> 
                                <th>
                                    <% var j=1; reparaciones_pendientes[i].forEach(reparacion => { %>
                                        <%= j %> 
                                        <%= reparacion.descripcion_reparacion %>
                                        <br> 
                                        
                                    <%j++  }) %>
                                
                                </th>
                                <th>
                                    <% var j=1; reparaciones_pendientes[i].forEach(reparacion => { %>
                                        #<%= j %>
                                        <% if (reparacion.mecanico_encargado!=0) { %>
                                            <%= arrmecanicos[reparacion.mecanico_encargado] %> 
                                        <% } else{%>
                                            sin asignacion
                                        <% }%>
                                        <br>
                                    <% j++}) %>
                                </th>
                                <td>video</td>
                                <td class="text-center"><a class="btnEditar btn btn-primary" id="editar_usuario">Editar</a>
                                    <a onclick="confirmar('<%= recepcion.id_recepcion %>','<%= arrclientes[recepcion.id_cliente] %>')" class="btnBorrar btn btn-danger" id="borrar_usuario">Eliminar</a>
                                    <a class="btnBorrar btn btn-success" id="borrar_usuario">Enviar Informe</a>
                                </td>
                                <% i++ %> 
                            </tr>
                            <% }) %>
                        </tbody>
                    </table>
                </div>
                <!---->
            </div>
            <br> <br>
        </div>
    </div> 
    <!-- modal recepcion -->
    <div class="modal fade" id="modal-recepcion" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="modal-recepcionLabel">Crear recepcion</h5>
            </div>
            <form id="formRecepcion" required>
                  <div class="modal-body">

                  <div class="form-group">
                      <label for="id_cliente" class="col-form-label">nombre del propietario:</label>
                      <select class="form-select" aria-label="Default select example" id="id_cliente" name="id_cliente" required>
                          <% clientes.forEach(cliente => { %>
                              <option value="<%= cliente.id_cliente %>"><%= cliente.nombre %></option>
                          <% }) %>
                      </select>
                  </div>
                <div class="form-group">
                    <label for="id_vehiculo" class="col-form-label">vehiculos registrados del propietario:</label>
                    <select class="form-select" aria-label="Default select example" id="id_vehiculo" name="id_vehiculo"  required>
                        <option selected disabled>porfavor elija un usuario primero</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="archivo">video de ingreso</label>
                    <input type="file" class="form-control-file" id="archivo" name="archivo" accept="video/mp4,video/x-m4v,video/*">
                  </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary close" >Cerrar</button>
                    <button type="submit" class="btn btn-primary">Siguiente</button>
                </div>
            </form>
          </div>
        </div>
    </div>
    
    <!-- modal reparaciones -->
    <div class="modal fade" id="modal-reparacion" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="modal-reparacionLabel">Crear reparacion</h5>
            </div>
            <form id="formReparacion" required>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="descripcion_reparacion" id="elegir_reparacion" class="col-form-label">elija una reparacion:</label>
                        <select class="form-select" aria-label="Default select example" id="descripcion_reparacion" name="descripcion_reparacion" required>
                            <% lista_reparaciones.forEach(reparacion => { %>
                                <option value="<%= reparacion.titulo_lista %>"><%= reparacion.titulo_lista %></option>
                            <% }) %>
                        </select>
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary closemecanico" >Cerrar</button>
                    <button type="submit" class="btn btn-primary">Guardar</button>
                </div>
            </form>
          </div>
        </div>
    </div>
    <script src="js/Principal.js"></script>
    
    <script> 
    var vehiculoslist= JSON.parse('<%- JSON.stringify(vehiculos) %>');
     </script>
    
    <%- include("../template/footer") %>    
    <script src="js/Admin_tabla.js"></script>